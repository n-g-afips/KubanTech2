<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <header>
            <h1>Показание приборов</h1>
        </header>
        <main>
            <div class="block_timers">
                <div  class="timers">
                    <canvas id="canvas" width="400" height="400" style="background-color:#F5F7FA"> </canvas>
                    <div class="index">TП 1</div>
                </div>
                <div  class="timers">
                    <canvas id="canvas1"  class="timers" width="400" height="400" style="background-color:#F5F7FA"> </canvas>
                    <div class="index">TП 2</div>
                </div>
                <div  class="timers">
                    <canvas id="canvas2" class="timers" width="400" height="400" style="background-color:#F5F7FA"> </canvas>
                    <div class="index">TП 3</div>
                </div>
            </div>
            <div class="block_timers">
                <div  class="timers">
                    <canvas id="canvas3" class="timers" width="400" height="400" style="background-color:#F5F7FA"> </canvas>
                    <div class="index">TП 4</div>
                </div>
                <div>
                    <div class="thermometer">
                        <div class="thermometer_1"></div>
                        <div class="thetmometer_2"></div>
                    </div>
                    <div class="containers">
                        <div class="line" id="l1">
                        <div class="line_text" id="id_line_text">143</div>
                        <div class="line_cover"></div>
                        </div>
                    </div>
                </div>
                <div  class="timers">
                    <canvas id="canvas4" class="timers" width="400" height="400" style="background-color:#F5F7FA"></canvas>
                    <div class="index">TП 5</div>
                </div>
            </div>
        </main>
        <footer>
            <span class="foot">Copyright <span>&copy;</span>&nbsp;2020 Product name &middot; Clocks</span>
            
        </footer>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script>
            $(function(){

            // jQuery methods go here...

            });
            // $.getJSON('https://mdn.github.io/learning-area/javascript/oojs/json/superheroes.json', function(data) {
            //     // JSON result in `data` variable
            //     console.log(data)
            // });
            var canvas = document.getElementById("canvas");
            var ctx = canvas.getContext("2d");
            var radius = canvas.height / 2;
            ctx.translate(radius, radius);
            radius = radius * 0.90
            setInterval(all_draw, 1000);

            let url = 'https://mdn.github.io/learning-area/javascript/oojs/json/superheroes.json';

            function all_draw(){

                //Сделать- получить с базы данных значения и внести их в функцию drawClocks
                drawClocks(x,y)
            }
            
            // fetch(url, {
            // mode: 'no-cors'
            // })
            // fetch(url)
            // .then(res => res.json())
            // .then((out) => {
            
            // console.log('Checkout this JSON! ', out);
            // })
            
            // .catch(err => { throw err });

            // function getJSONP(url, success) {

            //     var ud = '_' + +new Date,
            //         script = document.createElement('script'),
            //         head = document.getElementsByTagName('head')[0] 
            //             || document.documentElement;

            //     window[ud] = function(data) {
            //         head.removeChild(script);
            //         success && success(data);
            //     };

            //     script.src = url.replace('callback=?', 'callback=' + ud);
            //     head.appendChild(script);

            //     }

            // getJSONP('https://mdn.github.io/learning-area/javascript/oojs/json/superheroes.json', function(data){
            // console.log(data);
            // });  

            

            function drawClocks(x=105,y=145,x1=63,y1=121,x2=137,y2=24,x3=56,y3=127,x4=53,y4=72){
                drawClock(ctx,radius, x, y)
                drawClock(ctx1,radius1, x1, y1)
                drawClock(ctx2,radius2, x2, y2)
                drawClock(ctx3,radius3, x3, y3)
                drawClock(ctx4,radius4, x4, y4)
            }

            

            // function setup() {
            //     loadJSON
            // }

            var canvas1 = document.getElementById("canvas1");
            var ctx1 = canvas1.getContext("2d");
            var radius1 = canvas1.height / 2;
            ctx1.translate(radius1, radius1);
            radius1 = radius1 * 0.90
            // setInterval(drawClock1, 1000);

            var canvas2 = document.getElementById("canvas2");
            var ctx2 = canvas2.getContext("2d");
            var radius2 = canvas2.height / 2;
            ctx2.translate(radius2, radius2);
            radius2 = radius2 * 0.90
            // setInterval(drawClock2, 1000);

            var canvas3 = document.getElementById("canvas3");
            var ctx3 = canvas3.getContext("2d");
            var radius3 = canvas3.height / 2;
            ctx3.translate(radius3, radius3);
            radius3 = radius3 * 0.90
            // setInterval(drawClock3, 1000);

            var canvas4 = document.getElementById("canvas4");
            var ctx4 = canvas4.getContext("2d");
            var radius4 = canvas4.height / 2;
            ctx4.translate(radius4, radius4);
            radius4 = radius4 * 0.90
            // setInterval(drawClock4, 1000);

            function drawClock(ctx,radius, value_1, value_2) {
            drawFace(ctx, radius);
            drawNumbers(ctx, radius);
            drawSticks(ctx, radius)
            drawTime(ctx, radius, value_1,value_2);
            }

            function drawFace(ctx, radius) {
            var grad;
            ctx.beginPath();
            ctx.arc(0, 0, radius, 0, 2*Math.PI);
            ctx.fillStyle = 'black';
            ctx.fill();
            grad = ctx.createRadialGradient(0,0,radius*0.95, 0,0,radius*1.05);
            grad.addColorStop(0, '#333');
            grad.addColorStop(0.5, 'white');
            grad.addColorStop(1, '#333');
            ctx.strokeStyle = grad;
            ctx.lineWidth = radius*0.1;
            ctx.stroke();
            ctx.beginPath();
            ctx.arc(0, 0, radius*0.1, 0, 2*Math.PI);
            ctx.fillStyle = '#333';
            ctx.fill();
            }

            function drawSticks(ctx, radius){
                for(num = 0; num <= 90; num++){
                    var x;
                    var y;
                    ang = 3*num * Math.PI / 180 - Math.PI/4 + Math.PI;
                    ctx.beginPath();
                    ctx.lineWidth = radius*0.01;
                    x = Math.cos(ang)*radius;
                    y = Math.sin(ang)*radius;
                    ctx.moveTo(x*0.9,y*0.9);
                    ctx.lineTo(x*0.95,y*0.95);
                    ctx.strokeStyle = "white";
                    ctx.stroke();
                }
            }

            function drawNumbers(ctx, radius) {
            var ang;
            var num;
            ctx.font = radius*0.15 + "px arial";
            ctx.textBaseline="middle";
            ctx.textAlign="center";
            ctx.fillStyle = 'white';
            for(num = 0; num <= 150; num += 50){
                ang = num * Math.PI / 4 + Math.PI/4 + Math.PI;
                ctx.rotate(ang);
                ctx.translate(0, -radius*0.85);
                ctx.rotate(-ang);
                ctx.fillText(num.toString(), 0, 0);
                ctx.rotate(ang);
                ctx.translate(0, radius*0.8);
                ctx.rotate(-ang);
            }
            }

            function drawTime(ctx, radius, value_1, value_2){
                // var now = new Date();
                // var hour = now.getHours();
                // var minute = now.getMinutes();
                // var second = now.getSeconds();
                // hour=hour%12;
                // hour=(hour*Math.PI/6)+
                // (minute*Math.PI/(6*60))+
                // (second*Math.PI/(360*60));
                drawHand(ctx, value_1, radius*0.7, radius*0.05, strock='white');
                // minute=(minute*Math.PI/30)+(second*Math.PI/(30*60));
                drawHand(ctx, value_2, radius*0.7, radius*0.05, strock='red');
            }

            function drawHand(ctx, pos, length, width,strock='#333') {
                ctx.beginPath();
                ctx.lineWidth = width;
                ctx.lineCap = "round";
                ctx.moveTo(0,0);
                ctx.rotate(5*Math.PI/4 + pos*Math.PI*3/300);
                ctx.lineTo(0, -length);
                ctx.strokeStyle = strock;
                ctx.stroke();
                ctx.rotate(-5*Math.PI/4 - pos*Math.PI*3/300);
            }
        </script>
    </body>
</html>